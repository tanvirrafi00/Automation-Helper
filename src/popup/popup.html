<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Automation Framework Manager</title>
  <link rel="stylesheet" href="../../assets/css/popup.css">
</head>

<body>
  <div class="container">
    <!-- Header -->
    <header class="header">
      <h1>üöÄ Automation Framework Manager</h1>
      <div class="header-controls">
        <button id="themeToggle" class="btn-icon" title="Toggle Dark Mode">üåô</button>
      </div>
      <div class="project-selector">
        <select id="projectSelect">
          <option value="">No Project Selected</option>
        </select>
        <button id="newProjectBtn" class="btn btn-primary">+ New Project</button>
      </div>
    </header>

    <!-- Main Content -->
    <div class="content">
      <!-- Tab Navigation -->
      <nav class="tabs">
        <button class="tab-btn active" data-tab="dashboard">Dashboard</button>
        <button class="tab-btn" data-tab="pageObjects">Page Objects</button>
        <button class="tab-btn" data-tab="tests">Tests</button>
        <button class="tab-btn" data-tab="recorder">Recorder</button>
        <button class="tab-btn" data-tab="export">Export</button>
      </nav>

      <!-- Dashboard Tab -->
      <div class="tab-content active" id="dashboard">
        <div class="dashboard">
          <div class="stat-card">
            <h3>Page Objects</h3>
            <p class="stat-number" id="pageObjectCount">0</p>
          </div>
          <div class="stat-card">
            <h3>Test Specs</h3>
            <p class="stat-number" id="testSpecCount">0</p>
          </div>
          <div class="stat-card">
            <h3>Test Cases</h3>
            <p class="stat-number" id="testCaseCount">0</p>
          </div>
        </div>

        <div class="project-info" id="projectInfo">
          <h3>Project Information</h3>
          <p><strong>Tool:</strong> <span id="projectTool">-</span></p>
          <p><strong>Language:</strong> <span id="projectLanguage">-</span></p>
          <p><strong>Created:</strong> <span id="projectCreated">-</span></p>
          <p><strong>Last Updated:</strong> <span id="projectUpdated">-</span></p>
        </div>

        <div class="quick-actions">
          <button class="btn btn-secondary" id="createPageObjectBtn">Create Page Object</button>
          <button class="btn btn-secondary" id="createTestBtn">Create Test</button>
          <button class="btn btn-secondary" id="startRecordingBtn">Start Recording</button>
        </div>
      </div>

      <!-- Page Objects Tab -->
      <div class="tab-content" id="pageObjects">
        <div class="tab-header">
          <h2>Page Objects</h2>
          <input type="text" id="pageSearch" placeholder="Search pages..." class="search-input">
          <button class="btn btn-primary" id="addPageObjectBtn">+ Add Page Object</button>
        </div>
        <div class="page-objects-list" id="pageObjectsList">
          <p class="empty-state">No page objects yet. Create one to get started!</p>
        </div>
      </div>

      <!-- Tests Tab -->
      <div class="tab-content" id="tests">
        <div class="tab-header">
          <h2>Test Specifications</h2>
          <input type="text" id="testSearch" placeholder="Search tests..." class="search-input">
          <button class="btn btn-primary" id="addTestBtn">+ Add Test</button>
        </div>
        <div class="tests-list" id="testsList">
          <p class="empty-state">No tests yet. Create one to get started!</p>
        </div>
      </div>

      <!-- Recorder Tab -->
      <div class="tab-content" id="recorder">
        <div class="recorder-controls">
          <h2>üé¨ Step Recorder</h2>
          <div class="info-box"
            style="background: #eff6ff; padding: 12px; border-radius: 6px; margin-bottom: 16px; font-size: 13px;">
            <strong>üìù Instructions:</strong>
            <ol style="margin: 8px 0 0 20px; padding: 0;">
              <li>Select a Page Object and Test Suite below</li>
              <li>Enter a Test Case name (or use existing one)</li>
              <li>Click "Start Recording" and interact with your page</li>
              <li>Click "Stop Recording" when done</li>
              <li>Review generated code and click "Save to Project"</li>
            </ol>
          </div>
          <div class="recorder-settings">
            <label>
              Page Object: <span style="color: red;">*</span>
              <select id="recorderPageSelect" required>
                <option value="">Select Page Object</option>
              </select>
            </label>
            <label>
              Test Suite: <span style="color: red;">*</span>
              <select id="recorderTestSelect" required>
                <option value="">Select Test Suite</option>
              </select>
            </label>
            <label>
              Test Case Name: <span style="color: red;">*</span>
              <input type="text" id="recorderTestCase" placeholder="e.g. should login successfully" required>
            </label>
            <div class="recorder-options">
              <label>
                Annotation:
                <input type="text" id="stepAnnotation" placeholder="@smoke, @critical">
              </label>
              <label>
                Assertion:
                <select id="stepAssertion">
                  <option value="">None</option>
                  <option value="toBeVisible">Visible</option>
                  <option value="toHaveText">Have Text</option>
                  <option value="toBeEnabled">Enabled</option>
                </select>
              </label>
            </div>
          </div>
          <div class="recorder-buttons">
            <button class="btn btn-success" id="startRecBtn">‚è∫ Start Recording</button>
            <button class="btn btn-danger" id="stopRecBtn" disabled>‚èπ Stop Recording</button>
            <button class="btn btn-info" id="replayBtn">‚ñ∂ Replay</button>
            <button class="btn btn-warning" id="screenshotBtn">üì∑ Screenshot</button>
            <button class="btn btn-secondary" id="clearStepsBtn">üóë Clear Steps</button>
          </div>
          <div class="recording-status">
            Status: <span id="recordingStatus">Idle</span>
          </div>
        </div>
        <div class="recorded-steps" id="recordedSteps">
          <h3>Recorded Steps (<span id="stepCount">0</span>)</h3>
          <ul id="stepsList"></ul>
        </div>
        <div class="generated-code">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
            <h3>Generated Code Preview</h3>
            <button class="btn btn-primary" id="generateCodeBtn">üíæ Save to Project</button>
          </div>
          <pre id="generatedCode">// Select Page Object and Test Suite above, then start recording...</pre>
          <button class="btn btn-secondary" id="copyCodeBtn">üìã Copy Code</button>
        </div>
      </div>

      <!-- Export Tab -->
      <div class="tab-content" id="export">
        <h2>Export Project</h2>
        <div class="export-options">
          <div class="export-preview" id="exportPreview">
            <h3>Project Structure</h3>
            <pre id="projectStructure">Select a project to see structure...</pre>
          </div>
          <div class="export-actions">
            <button class="btn btn-primary" id="downloadZipBtn">üì¶ Download as ZIP</button>
            <button class="btn btn-secondary" id="downloadProjectBtn">‚¨á Download Files</button>
            <button class="btn btn-secondary" id="copyAllCodeBtn">üìã Copy All Code</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modals -->

  <!-- New Project Modal -->
  <div class="modal" id="newProjectModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Create New Project</h2>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <label>
          Project Name:
          <input type="text" id="projectName" placeholder="My Automation Project">
        </label>
        <label>
          Tool:
          <select id="projectTool">
            <option value="playwright">Playwright</option>
            <option value="selenium">Selenium</option>
            <option value="webdriverio">WebdriverIO</option>
          </select>
        </label>
        <label>
          Language:
          <select id="projectLanguage">
            <option value="typescript">TypeScript</option>
            <option value="javascript">JavaScript</option>
            <option value="python">Python</option>
            <option value="java">Java</option>
          </select>
        </label>
        <label>
          Template:
          <select id="projectTemplate">
            <option value="default">Default</option>
            <option value="web-form">Web Form</option>
            <option value="dashboard">Dashboard</option>
            <option value="e-commerce">E-commerce</option>
          </select>
        </label>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary modal-cancel">Cancel</button>
        <button class="btn btn-primary" id="createProjectBtn">Create Project</button>
      </div>
    </div>
  </div>

  <!-- New Page Object Modal -->
  <div class="modal" id="newPageObjectModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Create Page Object</h2>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <label>
          Page Name:
          <input type="text" id="pageName" placeholder="LoginPage">
        </label>
        <label>
          Page URL:
          <input type="text" id="pageUrl" placeholder="https://example.com/login">
        </label>
        <div class="checkbox-group">
          <input type="checkbox" id="autoDetectElements">
          <label for="autoDetectElements">Auto-detect elements on current page</label>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary modal-cancel">Cancel</button>
        <button class="btn btn-primary" id="createPageBtn">Create Page Object</button>
      </div>
    </div>
  </div>

  <!-- New Test Modal -->
  <div class="modal" id="newTestModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Add Test Case</h2>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <label>
          Action:
          <select id="testAction">
            <option value="new">Create New Test Suite</option>
            <option value="existing">Add to Existing Suite</option>
          </select>
        </label>
        <div id="newSuiteFields">
          <label>
            Test Suite Name:
            <input type="text" id="testName" placeholder="LoginTest">
          </label>
          <label>
            Page Object:
            <select id="testPageObject">
              <option value="">Select Page Object</option>
            </select>
          </label>
        </div>
        <div id="existingSuiteFields" style="display: none;">
          <label>
            Select Test Suite:
            <select id="existingTestSuite">
              <option value="">Select Suite</option>
            </select>
          </label>
        </div>
        <label>
          Test Case Name:
          <input type="text" id="testCaseName" placeholder="should login successfully">
        </label>
        <div class="checkbox-group">
          <input type="checkbox" id="isDataDriven">
          <label for="isDataDriven">Data Driven Test</label>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary modal-cancel">Cancel</button>
        <button class="btn btn-primary" id="createTestSpecBtn">Add Test Case</button>
      </div>
    </div>
  </div>

  <!-- Code Viewer Modal -->
  <div class="modal" id="codeViewerModal">
    <div class="modal-content large-modal">
      <div class="modal-header">
        <h2 id="codeViewerTitle">Code Viewer</h2>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <pre id="codeViewerContent" class="code-block"></pre>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary modal-cancel">Close</button>
        <button class="btn btn-primary" id="copyViewerCodeBtn">Copy Code</button>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="../../assets/js/jszip.min.js"></script>
  <script src="../utils/models.js"></script>
  <script src="../utils/codeGenerator.js"></script>
  <script src="../utils/projectManager.js"></script>
  <script src="../../assets/js/popup.js"></script>
</body>

</html>